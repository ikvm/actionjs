!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.app=e()}(this,function(){"use strict";function t(){return"undefined"!=typeof window}function e(t){return"function"==typeof t}function n(t){return t&&"[object Object]"===Object.prototype.toString.call(t)}function r(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(t){return Array.prototype.concat.apply([],t).slice()}function a(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function o(){var t=o.cached=o.cached||{},e=Math.random().toString(36).slice(2,10);return t[e]?o():t[e]=e}function c(t){for(var e=t.length-1;e>=0;e--)""!=t[e]&&void 0!=t[e]&&null!=t[e]||t.splice(e,1);return t}function u(t,e){return t.getAttribute(e)||""}function s(t){if(!t)return[];if(!t.match)return[t];if(!t.match(/\[|\]/))return t.split(/\./);var e=t.replace(/\[|\].|\]/g,".").replace(/\.$/,"");return e.split(/\./)}function f(){var t,i,a,o,c,u,s=arguments[0]||{},h=1,p=arguments.length,v=!1;for("boolean"==typeof s&&(v=s,s=arguments[1]||{},h=2),"object"==typeof s||e(s)||(s={}),p===h&&(s=this,--h);h<p;h++)if(null!=(t=arguments[h]))for(i in t)l(i)||(a=s[i],o=t[i],s!==o&&(v&&o&&(n(o)||(c=r(o)))?(c?(c=!1,u=a&&r(a)?a:[]):u=a&&n(a)?a:{},s[i]=f(v,u,o)):void 0!==o&&(s[i]=o)));return s}function l(t){return H.indexOf(t)>-1}function h(t,e,n,r){t.addEventListener?t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on"+e,n)}function p(){if(Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&!l(n)&&e.push(n);return e}),Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(t){return Object.keys(t)}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),"function"!=typeof Array.prototype.forEach&&(Array.prototype.forEach=function(t,e){var n,r;for(n=0,r=this.length;n<r;++n)n in this&&t.call(e,this[n],n,this)}),"function"!=typeof Array.prototype.indexOf&&(Array.prototype.indexOf=function(t,e){var n=-1;e=1*e||0;for(var r=0,i=this.length;r<i;r++)if(r>=e&&this[r]===t){n=r;break}return n}),"function"!=typeof Array.prototype.lastIndexOf&&(Array.prototype.lastIndexOf=function(t,e){var n=-1,r=this.length;e=1*e||r-1;for(var i=r-1;i>-1;i-=1)if(i<=e&&this[i]===t){n=i;break}return n}),!v()&&("__defineGetter__"in{}&&(Object.defineProperty=function(t,e,n){return"value"in n&&(t[e]=n.value),"get"in n&&t.__defineGetter__(e,n.get),"set"in n&&t.__defineSetter__(e,n.set),t}),document.documentMode<9)){var t;!function(){var e=function(t,e,n,r){this.key=e,this.val=n,this.get=function(){var n=r.get();return this.val==n&&(n=t[e],this.val!=n&&r.set(n)),n},this.set=r.set},n=function(){for(var e=0;e<t.length;e++){var n=t[e],r=n.get();n.val!=r&&(n.val=r,n.set(r))}};Object.getOwnPropertyDescriptor=function(){return null},Object.isExtensible=function(){return!0},t=[],Object.defineProperty=function(n,r,i){var a=n[r]=void 0!=i.value?i.value:i.get();if(i.get&&i.set){var o=new e(n,r,a,i);t.push(o)}},setTimeout(function(){setInterval(n,200)},1e3)}()}}function v(){try{Object.defineProperty({},"a",{value:0})}catch(t){return!1}return!0}function g(t,e,n){if(e.executing(n,t))for(var r=t.childNodes,i=0,a=r.length;i<a;i++)1===r[i].nodeType&&g(r[i],e,n);e.executed(n,t)}function d(){this.plugins=[],this.init=function(t){for(var n={},r=0,i=B.plugins.length;r<i;r++)if(e(B.plugins[r])){var a=new B.plugins[r];this.plugins.push(a),e(a.init)&&a.init(n,t,B)}return n},this.executing=function(t,n){for(var r=!1,i=0;i<this.plugins.length;i++){var a=this.plugins[i];0!=a.recursive&&(a.recursive=!e(a.executing)||a.executing(t,n)),0!=a.recursive&&(r=!0)}return r},this.executed=function(t,n){for(var r=0;r<this.plugins.length;r++){var i=this.plugins[r];e(i.executed)&&i.executed(t,n),i.recursive=!0}}}function b(t){return t.replace(ct,"").replace(ut,",").replace(st,"").replace(ft,"").replace(lt,"").split(ht)}function y(t){return"'"+t.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function m(t,e){function n(t){return f+=t.split(/\n/).length-1,u&&(t=t.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),t&&(t=p[1]+y(t)+p[2]+"\n"),t}function r(t){var n=f;if(c?t=c(t,e):i&&(t=t.replace(/\n/g,function(){return f++,"$line="+f+";"})),0===t.indexOf("=")){var r=s&&!/^=[=#]/.test(t);if(t=t.replace(/^=[=#]?|[\s;]*$/g,""),r){var a=t.replace(/\s*\([^\)]+\)/,"");et[a]||/^(include|print)$/.test(a)||(t="$escape("+t+")")}else t="$string("+t+")";t=p[1]+t+p[2]}return i&&(t="$line="+n+";"+t),at(b(t),function(t){if(t&&!l[t]){var e;e="print"===t?g:"include"===t?d:et[t]?"$utils."+t:nt[t]?"$helpers."+t:"$data."+t,m+=t+"="+e+",",l[t]=!0}}),t+"\n"}var i=e.debug,a=e.openTag,o=e.closeTag,c=e.parser,u=e.compress,s=e.escape,f=1,l={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},h="".trim,p=h?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],v=h?"$out+=text;return $out;":"$out.push(text);",g="function(){var text=''.concat.apply('',arguments);"+v+"}",d="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+v+"}",m="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(i?"$line=0,":""),$=p[0],_="return new String("+p[3]+");";at(t.split(a),function(t){t=t.split(o);var e=t[0],i=t[1];1===t.length?$+=n(e):($+=r(e),i&&($+=n(i)))});var w=m+$+_;i&&(w="try{"+w+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+y(t)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var x=new Function("$data","$filename",w);return x.prototype=et,x}catch(t){throw t.temp="function anonymous($data,$filename) {"+w+"}",t}}function $(t){this.render=C.compile(t)}function _(t,e){if(!(t instanceof _)){var n=t.____ob__||{},i=n.submap||{},a=n.watchs||[],o=n.parents||[];this.watch=function(t,e,n){t.indexOf("[")>-1&&(t=s(t).join(".")),n=f({deep:!0},n);var r={id:vt++,path:t,callback:e,options:n};return a.push(r),this.publishWatch(r),r.id},this.unwatch=function(t){for(var e=0;e<a.length;e++)a[e].id==t&&(this.revokeWatch(a[e]),a.splice(e,1))},this.queryTarget=function(e){return S(t,e)},this.publishWatch=function(e,n){for(var r=e?[e]:a,i=0;i<r.length;i++)if(!n||n(r[i])){var o=S(t,r[i].path);if(o){var c=dt.create(t,o,r[i]);o.ob.subscribe(c)}}},this.republishWatch=function(t,e){if(t&&this.publishWatch(0,function(e){return e.path==t||e.path.substr(0,t.length)==t}),e)for(var n=0;n<o.length;n++){var r=o[n].ob;r.republishWatch(o[n].key,e)}},this.revokeWatch=function(e){var n=S(t,e.path);n&&n.ob.unsubscribe(e.id)},this.subscribe=function(t){return dt.add(i,t),t.id},this.unsubscribe=function(t){dt.remove(i,t)},this.notify=function(t,e){for(var n=i[t]||[],r=0;r<n.length;r++)e&&!n[r].deep||gt.add(n[r]);for(var r=0;r<o.length;r++){var a=o[r].ob;a.notify(o[r].key,!0)}gt.fire()},this.addParent=function(e){if(e){var n=W(e.data,t);if(null!=n){for(var r=0;r<o.length;r++)if(o[r].ob===e)return void(o[r].key=n);o.push({key:n,ob:e})}}},this.removeParent=function(t){for(var e=0;e<o.length;e++)if(o[e].ob===t){o.splice(e,1);break}},this.observeProperty=function(e,n){x(t,e,n)},this.init=function(){if(this.data=t,t.__ob__||E(t,"__ob__",this),!t.$watch){var e=this;E(t,"$watch",function(){e.watch.apply(e,arguments)})}t.$value||Object.defineProperty(t,"$value",{enumerable:!1,configurable:!0,get:function(){return f(!0,r(t)?[]:{},t)}}),r(t)&&bt.augment(t),w(t)},this.init(),this.addParent(e),this.republishWatch(!1,!0)}}function w(t){for(var e=Object.keys(t),n=0,r=e.length;n<r;n++)x(t,e[n],t[e[n]])}function x(t,n,r){"$"==String(n).substr(0,1)||e(r)||P(t,n,r)}function O(t,e){this.ob=t.__ob__,this.key=e,this.get=function(){var i=t[e];return(n(i)||r(i))&&(i=i.$value||i),i},this.set=function(n){t[e]=n}}function j(){var t=[];this.add=function(e){t.indexOf(e)<0&&t.push(e)},this.fire=function(){clearTimeout(this.timeout),this.timeout=setTimeout(function(){for(;t.length;){var e=t.shift();e.update()}},0)}}function k(){function t(t,e,n){var r=t,i=e,a=n;this.id=a.id,this.key=i.key,this.deep=a.options.deep,this.value=i.get(),this.updateSetting=function(t,e,n){r=t,i=e,a=n,gt.add(this)},this.update=function(){var t=i.get(),e=this.value;e!==t&&(this.value=t,a.callback.call(r,t,e))}}var e={};this.create=function(n,r,i){var a=i.id;return e[a]?e[a].updateSetting(n,r,i):e[a]=new t(n,r,i),e[a]},this.add=function(t,e){var n=t[e.key];n||(n=t[e.key]=[]);for(var r=0;r<n.length;r++)if(n[r].id==e.id)return;n.push(e)},this.remove=function(t,n){for(var r in t){if(!a(t,r))return;for(var i=t[r]||[],o=0;o<i.length;o++)if(i[o].id==n)return i.splice(o,1),void delete e[n]}}}function A(){function t(t,e){t.__proto__=e}function e(t,e,n){for(var r=0,i=n.length;r<i;r++){var a=n[r];E(t,a,e[a])}}var n=Array.prototype,r=Object.create(n),i=Object.getOwnPropertyNames(r),a="__proto__"in{};["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(t){var e=n[t];E(r,t,function(){for(var n=arguments.length,r=new Array(n);n--;)r[n]=arguments[n];var i,a=e.apply(this,r),o=this.__ob__;switch(t){case"push":i=r;break;case"unshift":i=r;break;case"splice":i=r.slice(2)}i&&w(i);var c=W(o.data,this);return o.notify(c),a})}),E(n,"$set",function(t,e){return t>=this.length&&(this.length=Number(t)+1),this.splice(t,1,e)[0]}),E(n,"$remove",function(t){if(this.length){var e=indexOf(this,t);return e>-1?this.splice(e,1):void 0}});var o=a?t:e;this.augment=function(t){o(t,r,i)}}function P(t,e,n){var r=t.__ob__,i=Object.getOwnPropertyDescriptor(t,e);if(!i||i.configurable!==!1){var a=i&&i.get,o=i&&i.set;return T(n,r),Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=a?a.call(t):n;return e},set:function(i){var c=a?a.call(t):n;i!==c&&(o?o.call(t,i):n=i,T(i,r),r.notify(e))}}),t}}function T(t,e){if(t&&"object"==typeof t){var i;return a(t,"__ob__")&&t.__ob__ instanceof _?i=t.__ob__:(r(t)||n(t))&&Object.isExtensible(t)&&(i=new _(t,e)),i}}function E(t,e,n,r){t=Object.defineProperty(t,e,{value:n,enumerable:!!r,writable:!0,configurable:!0})}function S(t,e){for(var i,a=t,o=s(e);o.length&&(n(a)||r(a));){if(i=o.shift(),0==o.length&&a.__ob__)return new O(a,i);a=a[i]}return null}function W(t,e){if(!e)return null;for(var n in t)if(a(t,n)&&t[n]===e)return n;return null}function M(){this.init=function(e,n){e.root=n,e.browser=t()},this.executing=function(t,e){t.element=e},this.executed=function(t){t.element=null}}function L(){this.init=function(t,e,n){t.scope=n.scope},this.executing=function(t,e){this.parentScope=t.scope;var n=u(t.element,"scope");n&&(t.scope=this.parentScope[n]||{})},this.executed=function(t,e){t.scope=this.parentScope}}function N(){this.init=function(t,e){"undefined"!=typeof _&&new _(t.scope)}}function R(){function t(t,n,r){var i=t.__ob__,a=new _(n);for(var o in r)r.hasOwnProperty(o)&&!function(o){var c=i.queryTarget(r[o]),u=c.get();return e(u)?void(n[o]=u):(a.observeProperty(o,u),t.$watch(r[o],function(t,e){n[o]=t}),void n.$watch(o,function(t){c&&c.set(t)}))}(o);return n}function n(t){for(var e={data:{},mapping:{}},n=t.attributes,r=0;r<n.length;r++){var i=n[r],a=i.name.substr(0,5);"data."==a?e.mapping[i.name.substring(5)]=i.value:"data-"==a&&(e.data[i.name.substring(5)]=i.value)}return e}this.executing=function(e,r){var i=n(r);e.data=t(e.scope,i.data,i.mapping)}}function q(){function t(t){this.context=t,this.get=function(){if(!this.stages){var t=this.context.element.getAttribute("stage")||"";this.stages=t.replace(/\s*/g,"").split(",")}return this.stages},this.has=function(t){for(var e=this.get(),n=0,r=e.length;n<r;n++)if(t==e[n])return!0;return!1},this.set=function(t){var e=this.get();this.has(t)||e.push(t);var n=e.join(",").replace(/(^,*)|(,*$)/g,"");this.context.element.setAttribute("stage",n)}}this.executing=function(e,n){e.stage=new t(e)}}function I(){function t(t,a){if(u.actions[t]){var o=n(t),c=r(o,a);i("preact",o),c&&e(c.execute)&&c.execute(),i("sufact",o)}}function n(t){for(var e=[t],n=t.indexOf(".");n>-1;)t=t.substring(n+1),t&&e.unshift(t),n=t.indexOf(".");return e}function r(t,n){var r=u.actions[t[0]];if(!e(r))return null;var i=new r(n);i.id=o(),i.context=n,i.element=n.element,i.data=n.data;for(var a=1,s=t.length;a<s&&(r=u.actions[t[a]],e(r));a++)for(var f=new r(n),l=Object.keys(f);l.length;){var h=l.shift(),p=i[h],v=f[h];i[h]=e(v)?c(i,p,v):v}return i}function i(e,n){for(var r=0,i=n.length;o<i;r++)for(var a=u[e][n[r]]||[],o=0,c=a.length;o<c;o++)a[o]!=n[r]&&t(a[o],context)}function a(t){for(var e=[],n=t.attributes,r=0;r<n.length;r++){var i=n[r],a=i.name.split(".");if("action"==a[0]&&i.value){for(var o="",c=i.value.split(","),u=1;u<a.length;u++)a[u]&&(o+="."+a[u]);for(var s=0;s<c.length;s++)e.push(c[s]+o)}}return e}function c(t,e,n){return function(){t.base=e;var r=n.apply(t,arguments);return t.base=null,r}}var u;this.init=function(){u=arguments[2]},this.executing=function(e,n){for(var r=a(n),i=0;i<r.length;i++)t(r[i],e);return!0}}function D(t){function n(t,e){switch(document.documentMode<9&&(e=r(t,e)),t.type){case"radio":case"checkbox":return h(t,"click",e,!1);case"select":return h(t,"change",e,!1);default:return o(t,e)}}function r(t,e){var n;return function(r){clearTimeout(n),n=setTimeout(function(){e.call(t,r)},0)}}function a(t,e,n){return function(r){var a=r.target,o=i(t.querySelectorAll(e));if(o.indexOf(a)!=-1)return n.call(a,r)}}function o(t,e){if(h(t,"input",e,!1),9==document.documentMode){h(t,"change",e,!1);var n=function(n){e.call(t,n)};h(t,"focus",function(){document.addEventListener("selectionchange",n,!1)},!1),h(t,"blur",function(){document.removeEventListener("selectionchange",n,!1)},!1)}else document.documentMode<9&&(h(t,"change",e,!1),h(t,"propertychange",function(n){"value"==n.propertyName&&e.call(t,n)},!1))}this.listen=function(r,o,c){if(e(r)&&(c=o,o=r,r=""),r)if(c&&c.delegate)n(t,a(o));else for(var u=i(t.querySelectorAll(r)),s=0;s<u.length;s++)n(u[s],o);else n(t,o)}}function F(){this.execute=function(){var t=this.context.stage;t.has("render")||(this.render(),t.set("render")),this.context.browser&&!t.has("init")&&(this.init(),t.set("init"))},this.render=function(){if(!this.templateRender){var t=e(this.template)?this.template():this.template;this.templateRender=new $(t)}var n=this.templateRender.render(this.data);this.element.innerHTML=n},this.init=function(){},this.template=function(){return""},this.watch=function(t,e,n){for(var r=c(t.split(",")),i=0;i<r.length;i++)this.data.$watch(t,e,n)},this.listen=function(t,e,n){this.monitor||(this.monitor=new D(this.element)),this.monitor.listen(t,e,n)}}function G(){this.execute=function(){for(var t in this.data)this.data.hasOwnProperty(t)&&e(this.data[t])&&h(this.element,t,this.data[t])}}var H=["__ob__","$watch","$value"];p();var z={},B={config:{},scope:{},plugins:[],actions:{},preact:{},sufact:{}};z.config=function(t){f(B.config,t)},z.plugin=function(t){B.plugins.push(t)},z.scope=function(t,r){var i=arguments.length;1==i&&n(t)&&(r=t,t=o()),B.scope[t]=e(r)?new r:r},z.action=function(t,e,n){return e?(B.actions[t]=e,void(n&&(r(n.preact)&&(B.preact[t]=n.preact),r(n.sufact)&&(B.sufact[t]=n.preact)))):B.actions[t]},z.run=function(t){var e=t||document.body,n=new d,r=n.init(e);g(e,n,r)};var C=function(t,e){return"string"==typeof e?it(e,{filename:t}):Q(t,e)};C.version="3.0.0",C.config=function(t,e){J[t]=e};var J=C.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},K=C.cache={};C.render=function(t,e){return it(t,e)};var Q=C.renderFile=function(t,e){var n=C.get(t)||rt({filename:t,name:"Render Error",message:"Template not found"});return e?n(e):n};C.get=function(t){var e;if(K[t])e=K[t];else if("object"==typeof document){var n=document.getElementById(t);if(n){var r=(n.value||n.innerHTML).replace(/^\s*|\s*$/g,"");e=it(r,{filename:t})}}return e};var U=function t(e,n){return"string"!=typeof e&&(n=typeof e,"number"===n?e+="":e="function"===n?t(e.call(e)):""),e},V={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},X=function(t){return V[t]},Y=function(t){return U(t).replace(/&(?![\w#]+;)|[<>"']/g,X)},Z=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},tt=function(t,e){var n,r;if(Z(t))for(n=0,r=t.length;n<r;n++)e.call(t,t[n],n,t);else for(n in t)e.call(t,t[n],n)},et=C.utils={$helpers:{},$include:Q,$string:U,$escape:Y,$each:tt};C.helper=function(t,e){nt[t]=e};var nt=C.helpers=et.$helpers;C.onerror=function(t){var e="Template Error\n\n";for(var n in t)e+="<"+n+">\n"+t[n]+"\n\n";"object"==typeof console&&console.error(e)};var rt=function(t){return C.onerror(t),function(){return"{Template Error}"}},it=C.compile=function(t,e){function n(n){try{return new a(n,i)+""}catch(r){return e.debug?rt(r)():(e.debug=!0,it(t,e)(n))}}e=e||{};for(var r in J)void 0===e[r]&&(e[r]=J[r]);var i=e.filename;try{var a=m(t,e)}catch(t){return t.filename=i||"anonymous",t.name="Syntax Error",rt(t)}return n.prototype=a.prototype,n.toString=function(){return a.toString()},i&&e.cache&&(K[i]=n),n},at=et.$each,ot="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",ct=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,ut=/[^\w$]+/g,st=new RegExp(["\\b"+ot.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),ft=/^\d[^,]*|,\d[^,]*/g,lt=/^,+|,+$/g,ht=/^$|,+/;J.openTag="{{",J.closeTag="}}";var pt=function(t,e){var n=e.split(":"),r=n.shift(),i=n.join(":")||"";return i&&(i=", "+i),"$helpers."+r+"("+t+i+")"};J.parser=function(t,e){t=t.replace(/^\s/,"");var n=t.split(" "),r=n.shift(),i=n.join(" ");switch(r){case"if":t="if("+i+"){";break;case"else":n="if"===n.shift()?" if("+n.join(" ")+")":"",t="}else"+n+"{";break;case"/if":t="}";break;case"each":var a=n[0]||"$data",o=n[1]||"as",c=n[2]||"$value",u=n[3]||"$index",s=c+","+u;"as"!==o&&(a="[]"),t="$each("+a+",function("+s+"){";break;case"/each":t="});";break;case"echo":t="print("+i+");";break;case"print":case"include":t=r+"("+n.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(i)){var f=!0;0===t.indexOf("#")&&(t=t.substr(1),f=!1);for(var l=0,h=t.split("|"),p=h.length,v=h[l++];l<p;l++)v=pt(v,h[l]);t=(f?"=":"=#")+v}else t=C.helpers[r]?"=#"+r+"("+n.join(",")+");":"="+t}return t},$.filter=C.helper;var vt=1,gt=new j,dt=new k,bt=new A;return z.plugin(M),z.plugin(L),z.plugin(N),z.plugin(R),z.plugin(q),z.plugin(I),z.filter=$.filter,z.action("tag",F),z.action("event",G),z});